<div class="card shadow-sm">
  <div class="card-header d-flex justify-content-between align-items-center bg-white">
    <h5 class="mb-0">Expiring Medicines Report</h5>
    <button class="btn btn-outline-primary btn-sm" (click)="exportToCsv()">
      <i class="bi bi-download me-1"></i> Export to CSV
    </button>
  </div>
  <div class="card-body">
    <!-- Loading spinner -->
    <div *ngIf="isLoading" class="text-center py-4">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-2 text-muted">Loading expiring medicines data...</p>
    </div>
    
    <!-- Error message -->
    <div *ngIf="error && !isLoading" class="alert alert-danger">
      <i class="bi bi-exclamation-triangle-fill me-2"></i>
      {{ error }}
      <button type="button" class="btn btn-sm btn-outline-danger ms-2" (click)="loadExpiringMedicines()">
        <i class="bi bi-arrow-clockwise"></i> Retry
      </button>
    </div>
    
    <!-- Data table -->
    <div *ngIf="!isLoading && !error && medicines.length > 0" class="table-responsive">
      <table class="table table-striped table-hover">
        <thead class="table-light">
          <tr>
            <th>Medicine ID</th>
            <th>Medicine Name</th>
            <th>Batch No</th>
            <th>Expiry Date</th>
            <th>Stock Quantity</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let medicine of medicines">
            <td>{{ medicine.medicineId || medicine.id }}</td>
            <td>{{ medicine.name }}</td>
            <td>{{ medicine.batchNo }}</td>
            <td>{{ medicine.expiryDate | date:'yyyy-MM-dd' }}</td>
            <td>{{ medicine.stockQuantity }}</td>
            <td>
              <span class="badge" [ngClass]="getStatusClass(medicine.expiryDate)">
                {{ getExpiryStatus(medicine.expiryDate) }}
              </span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <!-- Empty state -->
    <div *ngIf="!isLoading && !error && medicines.length === 0" class="text-center py-4">
      <i class="bi bi-calendar-check text-muted" style="font-size: 2rem;"></i>
      <p class="mt-3 text-muted">No expiring medicines found</p>
    </div>
  </div>
</div>
